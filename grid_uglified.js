var sw=0,db=[],edit_row=[],ins_row=[],tmp=-1,greenblue="#00c2ab",bright_greenblue="#e9fffc",white="#ffffff";function cell_reset(){var e=$("#"+tmp+"_1"),t=$("#"+tmp+"_2"),l=$("#"+tmp+"_3"),r="#616161";e.css("backgroundColor",white),t.css("backgroundColor",white),l.css("backgroundColor",white),e.css("color",r),t.css("color",r),l.css("color",r),$("#output_area").val(""),tmp=-1}function disabled(){var e=$("#save_btn"),t=$("#name"),l=$("#part"),r=$("#hint1"),o=$("#hint2"),c="#b1b1b1";e.attr("disabled",!0),t.attr("disabled",!0),l.attr("disabled",!0),e.css("borderColor",c),e.css("color",c),r.css("color",c),o.css("color",c)}function abled(){var e=$("#save_btn"),t=$("#name"),l=$("#part"),r=$("#hint1"),o=$("#hint2"),c=greenblue;e.attr("disabled",!1),t.attr("disabled",!1),l.attr("disabled",!1),e.css("borderColor",c),e.css("color",c),r.css("color",c),o.css("color",c)}function isNotEmpty(e,t){return""==e?(alert("이름을 입력하세요"),!1):""!=t||(alert("부서를 입력하세요"),!1)}function clear(){$("#name").val(""),$("#part").val("")}function add(){var e=$("#add_btn");1!=sw?(sw=1,e.css("backgroundColor",greenblue),e.css("color",bright_greenblue),-1!=tmp&&cell_reset(),abled()):(sw=0,e.css("backgroundColor",bright_greenblue),e.css("color",greenblue),disabled()),clear()}function view(){0!=edit_row.length&&0!=ins_row.length&&confirm("마지막으로 저장을 한 이후의 변경사항이 있을 경우 초기화됩니다.\n계속하시겠습니까?")&&(location.href=window.location.href)}function send(){if(0==edit_row.length&&0==ins_row.length)alert("1회 이상의 추가 혹은 수정이 이루어져야 DB에 저장하실 수 있습니다.");else if(confirm("변경 내용을 DB에 저장하시겠습니까?")){for(var e="",t=0;t<db.length;t++)for(var l=0;l<3;l++)e+="<input type='hidden' name='db_"+t+"_"+l+"' value='"+db[t][l]+"'> ";if(e+="<input type='hidden' name='edit_length' value='"+edit_row.length+"'> ",e+="<input type='hidden' name='ins_length' value='"+ins_row.length+"'> ",0<edit_row.length)for(t=0;t<edit_row.length;t++)e+="<input type='hidden' name='edit_"+t+"' value='"+edit_row[t]+"'> ";if(0<ins_row.length)for(t=0;t<ins_row.length;t++)e+="<input type='hidden' name='ins_"+t+"' value='"+ins_row[t]+"'> ";document.write("<form action='/save' id='post' method='post'> "+e+"</form>"),$("#post").submit()}}function cell_focus(e){var t,l,r,o;2!=sw?(o=$("#add_btn"),1==sw&&(o.css("backgroundColor",bright_greenblue),o.css("color",greenblue)),sw=2,abled(),t=$("#"+e+"_1"),l=$("#"+e+"_2"),r=$("#"+e+"_3"),o=$("#output_area"),t.css("backgroundColor",greenblue),l.css("backgroundColor",greenblue),r.css("backgroundColor",greenblue),t.css("color",white),l.css("color",white),r.css("color",white),tmp=e,$("#name").val(db[e-1][1]),$("#part").val(db[e-1][2]),o.val(db[e-1][1]+", "+db[e-1][2])):e!=tmp?(cell_reset(),t=$("#"+e+"_1"),l=$("#"+e+"_2"),r=$("#"+e+"_3"),o=$("#output_area"),t.css("backgroundColor",greenblue),l.css("backgroundColor",greenblue),r.css("backgroundColor",greenblue),t.css("color",white),l.css("color",white),r.css("color",white),tmp=e,$("#name").val(db[e-1][1]),$("#part").val(db[e-1][2]),o.val(db[e-1][1]+", "+db[e-1][2])):(cell_reset(),sw=0,disabled(),clear())}function save(){var e,t,l,r=$("#name").val(),o=$("#part").val();switch(sw){case 1:isNotEmpty(r,o)&&(e=$("#grid_main"),l="",l+="<tr>",l+="<td><center><div class='cell' id='"+(t=$("#grid_main tr").length)+"_1' onclick='cell_focus("+t+")'>"+t+"</div></center></td>",l+="<td><center><div class='cell' id='"+t+"_2' onclick='cell_focus("+t+")'>"+r+"</div></center></td>",l+="<td><center><div class='cell' id='"+t+"_3' onclick='cell_focus("+t+")'>"+o+"</div></center></td>",l+="</tr>",e.append(l),db[db.length]=[t,r,o],ins_row.push(t),alert("추가완료"),clear());break;case 2:isNotEmpty(r,o)&&($("#"+tmp+"_2").html(r),$("#"+tmp+"_3").html(o),db[tmp-1]=[tmp,r,o],$("#output_area").val(r+", "+o),edit_row.indexOf(tmp)<0&&edit_row.push(tmp),alert("수정완료"));break;default:alert("수정하시려면 해당 행을 누르시고, 추가하려면 [추가]를 누르세요")}}$(function(){for(i=0;i<$(".cell").length;i+=3){var e=$(".cell").eq(i).html();$(".cell").eq(i).attr("id",e+"_1"),$(".cell").eq(i+1).attr("id",e+"_2"),$(".cell").eq(i+2).attr("id",e+"_3"),$(".cell").eq(i).attr("onclick","cell_focus("+e+")"),$(".cell").eq(i+1).attr("onclick","cell_focus("+e+")"),$(".cell").eq(i+2).attr("onclick","cell_focus("+e+")"),db[db.length]=[e,$(".cell").eq(i+1).html(),$(".cell").eq(i+2).html()]}});